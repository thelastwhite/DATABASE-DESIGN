# DATABASE-DESIGN
Design a database for second hand car company

# Add ADDRESS TABLE
CREATE TABLE  "ADDRESS" 
   (	"LINE_1" VARCHAR2(30), 
	"LINE_2" VARCHAR2(30), 
	"LINE_3" VARCHAR2(30), 
	"LINE_4" VARCHAR2(30), 
	"CITY" VARCHAR2(30), 
	"COUNTRY" VARCHAR2(30), 
	"POST_CODE" VARCHAR2(30), 
	"ADDRESS_NO" NUMBER(5,0), 
	 CONSTRAINT "ADDRESS_PK" PRIMARY KEY ("ADDRESS_NO")
  USING INDEX  ENABLE
   )
/

CREATE OR REPLACE EDITIONABLE TRIGGER  "BI_ADDRESS" 
  before insert on "ADDRESS"               
  for each row  
begin   
  if :NEW."ADDRESS_NO" is null then 
    select "ADDRESS_SEQ".nextval into :NEW."ADDRESS_NO" from sys.dual; 
  end if; 
end; 

/
ALTER TRIGGER  "BI_ADDRESS" ENABLE
/

# Add ADVERTISED_PRICE TABLE
CREATE TABLE  "ADVERTISED_PRICE" 
   (	"CAR_NO" NUMBER(5,0), 
	"FROM_DATE" DATE, 
	"PRICE" NUMBER(10,2), 
	"NOTES" VARCHAR2(50), 
	 CONSTRAINT "ADVERTISED_PRICE_PK" PRIMARY KEY ("CAR_NO", "FROM_DATE")
  USING INDEX  ENABLE
   )
/
ALTER TABLE  "ADVERTISED_PRICE" ADD CONSTRAINT "ADVERTISED_PRICE_FK" FOREIGN KEY ("CAR_NO")
	  REFERENCES  "CAR" ("CAR_NO") ENABLE
	  /
	  
# Add ASSIST TABLE
CREATE TABLE  "ASSISTS" 
   (	"CUSTOMER_NO" NUMBER(5,0), 
	"STAFF_NO" NUMBER(5,0), 
	"DATE_RECORDED" DATE, 
	"NOTES" VARCHAR2(50), 
	 CONSTRAINT "ASSISTS_PK" PRIMARY KEY ("CUSTOMER_NO", "STAFF_NO")
  USING INDEX  ENABLE
   )
/
ALTER TABLE  "ASSISTS" ADD CONSTRAINT "ASSISTS_FK1" FOREIGN KEY ("CUSTOMER_NO")
	  REFERENCES  "CUSTOMER" ("CUSTOMER_NO") ENABLE
/
ALTER TABLE  "ASSISTS" ADD CONSTRAINT "ASSISTS_FK2" FOREIGN KEY ("STAFF_NO")
	  REFERENCES  "STAFF" ("STAFF_NO") ENABLE
	  /
	  
	 #Add BASED_AT TABL
	 
	 CREATE TABLE  "BASED_AT" 
   (	"STAFF_NO" NUMBER(5,0), 
	"BRANCH_NO" NUMBER(5,0), 
	"DATE_FROM" DATE, 
	"DATE_TO" DATE, 
	"NOTES" VARCHAR2(50), 
	 CONSTRAINT "BASED_AT_PK" PRIMARY KEY ("STAFF_NO", "BRANCH_NO")
  USING INDEX  ENABLE
   )
/
ALTER TABLE  "BASED_AT" ADD CONSTRAINT "BASED_AT_FK1" FOREIGN KEY ("STAFF_NO")
	  REFERENCES  "STAFF" ("STAFF_NO") ENABLE
/
ALTER TABLE  "BASED_AT" ADD CONSTRAINT "BASED_AT_FK2" FOREIGN KEY ("BRANCH_NO")
	  REFERENCES  "BRANCH" ("BRANCH_NO") ENABLE
/

#Add BRANCH TABLE
CREATE TABLE  "BRANCH" 
   (	"BRANCH_NO" NUMBER(2,0), 
	"BRANCH_NAME" VARCHAR2(30), 
	"ADDRESS_NO" NUMBER(5,0), 
	 CONSTRAINT "BRANCH_PK" PRIMARY KEY ("BRANCH_NO")
  USING INDEX  ENABLE
   )
/
ALTER TABLE  "BRANCH" ADD CONSTRAINT "BRANCH_FK1" FOREIGN KEY ("ADDRESS_NO")
	  REFERENCES  "ADDRESS" ("ADDRESS_NO") ENABLE
/

CREATE OR REPLACE EDITIONABLE TRIGGER  "BI_BRANCH" 
  before insert on "BRANCH"               
  for each row  
begin   
  if :NEW."BRANCH_NO" is null then 
    select "BRANCH_SEQ".nextval into :NEW."BRANCH_NO" from sys.dual; 
  end if; 
end; 

/
ALTER TRIGGER  "BI_BRANCH" ENABLE
/

#Add CAR TABLE
CREATE TABLE  "CAR" 
   (	"CAR_NO" NUMBER(5,0), 
	"FIRST_REG_DATE" DATE, 
	"ORIGINAL_REG_NO" VARCHAR2(30) NOT NULL ENABLE, 
	"NEW_REG_NO" VARCHAR2(30), 
	"MAKE" VARCHAR2(30), 
	"MODEL" VARCHAR2(30), 
	"CURRENT_MILEAGE" NUMBER(10,2), 
	"ENGINE_SIZE" NUMBER(2,1), 
	"FUEL_TYPE" CHAR(1), 
	"TRANSMISSION" CHAR(1), 
	"BODY_TYPE" CHAR(1), 
	"NO_DOORS" NUMBER(1,0), 
	"INSURANCE_GROUP" NUMBER(5,0), 
	"NO_OWNERS" NUMBER(2,0), 
	"COLOUR" VARCHAR2(30), 
	"PURCHASE_PRICE" NUMBER(10,2), 
	"PURCHASE_DATE" DATE, 
	"SOLD_PRICE" NUMBER(10,2), 
	"SOLD_DATE" DATE, 
	"PURCHASE_BY_STAFF_NO" NUMBER(5,0) NOT NULL ENABLE, 
	"SOLD_BY_STAFF_NO" NUMBER(5,0), 
	"SERVICE_INTERVAL" NUMBER(6,0), 
	"BOUGHT_BY_CUSTOMER_NO" NUMBER(5,0), 
	"SOLD_BY_COSUTOMER_NO" NUMBER(5,0) NOT NULL ENABLE, 
	 CONSTRAINT "CAR1_PK" PRIMARY KEY ("CAR_NO")
  USING INDEX  ENABLE, 
	 CONSTRAINT "CAR_CC1" CHECK (BODY_TYPE IN ('S','M','H','C','V')) ENABLE, 
	 CONSTRAINT "CAR_CC2" CHECK (FUEL_TYPE IN ('P','D','B')) ENABLE, 
	 CONSTRAINT "CAR_CC3" CHECK (TRANSMISSION IN ('M','A','S')) ENABLE
   )
/
ALTER TABLE  "CAR" ADD CONSTRAINT "CAR_FK1" FOREIGN KEY ("PURCHASE_BY_STAFF_NO")
	  REFERENCES  "STAFF" ("STAFF_NO") ENABLE
/
ALTER TABLE  "CAR" ADD CONSTRAINT "CAR_FK2" FOREIGN KEY ("SOLD_BY_STAFF_NO")
	  REFERENCES  "STAFF" ("STAFF_NO") ENABLE
/
ALTER TABLE  "CAR" ADD CONSTRAINT "CAR_FK3" FOREIGN KEY ("BOUGHT_BY_CUSTOMER_NO")
	  REFERENCES  "CUSTOMER" ("CUSTOMER_NO") ENABLE
/
ALTER TABLE  "CAR" ADD CONSTRAINT "CAR_FK4" FOREIGN KEY ("SOLD_BY_COSUTOMER_NO")
	  REFERENCES  "CUSTOMER" ("CUSTOMER_NO") ENABLE
/

CREATE OR REPLACE EDITIONABLE TRIGGER  "BI_CAR1" 
  before insert on "CAR"               
  for each row  
begin   
  if :NEW."CAR_NO" is null then 
    select "CAR_SEQ2".nextval into :NEW."CAR_NO" from sys.dual; 
  end if; 
end; 

/
ALTER TRIGGER  "BI_CAR1" ENABLE
/

#Add INTERESTED_IN TABLE
CREATE TABLE  "CAR_INTERESTED" 
   (	"CUSTOMER_NO" NUMBER(5,0), 
	"CAR_NO" NUMBER(5,0), 
	"DATE_RECORDED" DATE, 
	"NOTES" VARCHAR2(50), 
	 CONSTRAINT "CAR_INTERESTED_PK" PRIMARY KEY ("CUSTOMER_NO", "CAR_NO")
  USING INDEX  ENABLE
   )
/
ALTER TABLE  "CAR_INTERESTED" ADD CONSTRAINT "CAR_INTERESTED_FK1" FOREIGN KEY ("CUSTOMER_NO")
	  REFERENCES  "CUSTOMER" ("CUSTOMER_NO") ENABLE
/
ALTER TABLE  "CAR_INTERESTED" ADD CONSTRAINT "CAR_INTERESTED_FK2" FOREIGN KEY ("CAR_NO")
	  REFERENCES  "CAR" ("CAR_NO") ENABLE
/

#Add CUSTOMER TABLE
CREATE TABLE  "CUSTOMER" 
   (	"CUSTOMER_NO" NUMBER(5,0), 
	"FIRST_NAME" VARCHAR2(30), 
	"SURNAME" VARCHAR2(30), 
	"TITLE" VARCHAR2(30), 
	"ADDRESS_NO" NUMBER(5,0), 
	 CONSTRAINT "CUSTOMER_PK" PRIMARY KEY ("CUSTOMER_NO")
  USING INDEX  ENABLE
   )
/
ALTER TABLE  "CUSTOMER" ADD CONSTRAINT "CUSTOMER_FK" FOREIGN KEY ("ADDRESS_NO")
	  REFERENCES  "ADDRESS" ("ADDRESS_NO") ENABLE
/

CREATE OR REPLACE EDITIONABLE TRIGGER  "BI_CUSTOMER" 
  before insert on "CUSTOMER"               
  for each row  
begin   
  if :NEW."CUSTOMER_NO" is null then 
    select "CUSTOMER_SEQ".nextval into :NEW."CUSTOMER_NO" from sys.dual; 
  end if; 
end; 

/
ALTER TRIGGER  "BI_CUSTOMER" ENABLE
/

#Add CUSTOMER_PHONE TABLE
CREATE TABLE  "CUSTOMER_PHONE" 
   (	"CUSTOMER_NO" NUMBER(5,0), 
	"PHONE_NO" VARCHAR2(13), 
	"TYPE" CHAR(1), 
	"NOTES" VARCHAR2(50), 
	 CONSTRAINT "CUSTOMER_PHONE_PK" PRIMARY KEY ("CUSTOMER_NO", "PHONE_NO")
  USING INDEX  ENABLE, 
	 CONSTRAINT "CUSTOMER_PHONE_CK1" CHECK (TYPE IN ('M','T')) ENABLE
   )
/
ALTER TABLE  "CUSTOMER_PHONE" ADD CONSTRAINT "CUSTOMER_PHONE_FK1" FOREIGN KEY ("CUSTOMER_NO")
	  REFERENCES  "CUSTOMER" ("CUSTOMER_NO") ENABLE
/

# ADD MODIFICATION TABLE
CREATE TABLE  "MODIFICATION" 
   (	"MODIFICATION_NO" NUMBER(5,0), 
	"CAR_NO" NUMBER(5,0), 
	"DATE_RECORDED" DATE, 
	"MODIFICATION_DESCRIPTION" VARCHAR2(50), 
	 CONSTRAINT "MODIFICATION_PK" PRIMARY KEY ("MODIFICATION_NO")
  USING INDEX  ENABLE
   )
/
ALTER TABLE  "MODIFICATION" ADD CONSTRAINT "MODIFICATION_FK1" FOREIGN KEY ("CAR_NO")
	  REFERENCES  "CAR" ("CAR_NO") ENABLE
/

CREATE OR REPLACE EDITIONABLE TRIGGER  "BI_MODIFICATION" 
  before insert on "MODIFICATION"               
  for each row  
begin   
  if :NEW."MODIFICATION_NO" is null then 
    select "MODIFICATION_SEQ".nextval into :NEW."MODIFICATION_NO" from sys.dual; 
  end if; 
end; 

/
ALTER TRIGGER  "BI_MODIFICATION" ENABLE
/

#ADD OPTIONAL_EXTRA TABLE
CREATE TABLE  "OPTIONAL_EXTRA" 
   (	"OPTIONAL_EXTRA_NO" NUMBER(5,0), 
	"CAR_NO" NUMBER(5,0), 
	"DATE_RECORDED" DATE, 
	"OPTIONAL_EXTRA_DESCRIPTION" VARCHAR2(50), 
	 CONSTRAINT "OPTIONAL_EXTRA_PK" PRIMARY KEY ("OPTIONAL_EXTRA_NO")
  USING INDEX  ENABLE
   )
/
ALTER TABLE  "OPTIONAL_EXTRA" ADD CONSTRAINT "OPTIONAL_EXTRA_FK" FOREIGN KEY ("CAR_NO")
	  REFERENCES  "CAR" ("CAR_NO") ENABLE
/

CREATE OR REPLACE EDITIONABLE TRIGGER  "BI_OPTIONAL_EXTRA" 
  before insert on "OPTIONAL_EXTRA"               
  for each row  
begin   
  if :NEW."OPTIONAL_EXTRA_NO" is null then 
    select "OPTIONAL_EXTRA_SEQ".nextval into :NEW."OPTIONAL_EXTRA_NO" from sys.dual; 
  end if; 
end; 

/
ALTER TRIGGER  "BI_OPTIONAL_EXTRA" ENABLE
/
#ADD SERVICE_HISTORY TABLE
CREATE TABLE  "SERVICE_HISTORY" 
   (	"CAR_NO" NUMBER(5,0), 
	"SERVICE_DATE" DATE, 
	"MILEAGE" NUMBER(10,2), 
	"NOTES" VARCHAR2(50), 
	 CONSTRAINT "SERVICE_HISTORY_PK" PRIMARY KEY ("CAR_NO", "SERVICE_DATE")
  USING INDEX  ENABLE
   )
/
ALTER TABLE  "SERVICE_HISTORY" ADD CONSTRAINT "SERVICE_HISTORY_FK" FOREIGN KEY ("CAR_NO")
	  REFERENCES  "CAR" ("CAR_NO") ENABLE
/
#ADD STAFF TABLE
CREATE TABLE  "STAFF" 
   (	"STAFF_NO" NUMBER(4,0), 
	"FIRST_NAME" VARCHAR2(30), 
	"SURNAME" VARCHAR2(30), 
	 CONSTRAINT "STAFF_PK" PRIMARY KEY ("STAFF_NO")
  USING INDEX  ENABLE
   )
/

CREATE OR REPLACE EDITIONABLE TRIGGER  "BI_STAFF" 
  before insert on "STAFF"               
  for each row  
begin   
  if :NEW."STAFF_NO" is null then 
    select "STAFF_SEQ".nextval into :NEW."STAFF_NO" from sys.dual; 
  end if; 
end; 

/
ALTER TRIGGER  "BI_STAFF" ENABLE
/

#ADD STAFF_PHONE TABLE
CREATE TABLE  "STAFF_PHONE" 
   (	"STAFF_NO" NUMBER(5,0), 
	"PHONE_NO" VARCHAR2(13), 
	"TYPE" CHAR(1), 
	"NOTES" VARCHAR2(50), 
	 CONSTRAINT "STAFF_PHONE_PK" PRIMARY KEY ("STAFF_NO", "PHONE_NO")
  USING INDEX  ENABLE, 
	 CONSTRAINT "STAFF_PHONE_CK1" CHECK (TYPE IN ('M','T')) ENABLE
   )
/
ALTER TABLE  "STAFF_PHONE" ADD CONSTRAINT "STAFF_PHONE_FK1" FOREIGN KEY ("STAFF_NO")
	  REFERENCES  "STAFF" ("STAFF_NO") ENABLE
/
#ADD STORED_AT TABLE
CREATE TABLE  "STORED_AT" 
   (	"CAR_NO" NUMBER(5,0), 
	"BRANCH_NO" NUMBER(2,0), 
	"FROM_DATE" DATE, 
	"NOTES" VARCHAR2(50), 
	 CONSTRAINT "STORED_AT_PK" PRIMARY KEY ("CAR_NO", "BRANCH_NO")
  USING INDEX  ENABLE
   )
/
ALTER TABLE  "STORED_AT" ADD CONSTRAINT "STORED_AT_FK1" FOREIGN KEY ("CAR_NO")
	  REFERENCES  "CAR" ("CAR_NO") ENABLE
/
ALTER TABLE  "STORED_AT" ADD CONSTRAINT "STORED_AT_FK2" FOREIGN KEY ("BRANCH_NO")
	  REFERENCES  "BRANCH" ("BRANCH_NO") ENABLE
/

# GENERATE THE SALES VIEW IN APRIL 2016
CREATE OR REPLACE VIEW "VU_SALES_REPORT" ("April 2016 Sales Report") AS SELECT
CHR(10)||CHR(10)||CUSTOMER.FIRST_NAME||' '||CUSTOMER.SURNAME||' of '||CHR(10)|| '
'||ADDRESS.LINE_1||', '||CHR(10)|| ' '||ADDRESS.LINE_2||', '||CHR(10)|| '
'||ADDRESS.CITY||CHR(10)|| ' bought a '||CAR.MAKE||' '||CAR.MODEL||CHR(10)|| ' on
'||TO_CHAR(CAR.SOLD_DATE,'DD MONTH YYYY')||CHR(10)|| ' for £'||CAR.SOLD_PRICE||CHR(10)|| '
making a profit of £'||TO_CHAR(CAR.SOLD_PRICE - CAR.PURCHASE_PRICE)||CHR(10)|| ' for sales person
'||STAFF.FIRST_NAME||' '||STAFF.SURNAME AS "2016 Sales Report" FROM CUSTOMER, CAR, ADDRESS, STAFF
WHERE CUSTOMER.CUSTOMER_NO=CAR.BOUGHT_BY_CUSTOMER_NO AND CUSTOMER.ADDRESS_NO=ADDRESS.ADDRESS_NO AND
CAR.SOLD_BY_STAFF_NO=STAFF.STAFF_NO AND CAR.SOLD_DATE>'04/01/2016' AND CAR.SOLD_DATE<'04/30/2016'

# GENERATE THE PURCHASE VIEW IN APRIL 2016
CREATE OR REPLACE VIEW "VU_PURCHASES_REPORT" ("April 2016 Purchases Report") AS SELECT distinct
CHR(10)||CHR(10)||STAFF.FIRST_NAME||' '||STAFF.SURNAME||' of '||CHR(10)|| '
CARS-4-U SHEFFIELD purchased a '||CAR.MAKE||' '||CAR.MODEL||CHR(10)|| ' on
'||TO_CHAR(CAR.PURCHASE_DATE,'DD MONTH YYYY')||CHR(10)|| ' for £'||CAR.PURCHASE_PRICE||CHR(10)|| ' from customer
'||CUSTOMER.FIRST_NAME||' '||CUSTOMER.SURNAME AS "2016 Purchases Report" FROM CUSTOMER, CAR, ADDRESS, STAFF
WHERE CUSTOMER.CUSTOMER_NO=CAR.SOLD_BY_COSUTOMER_NO AND CAR.SOLD_DATE>'04/01/2016' AND CAR.SOLD_DATE<'04/30/2016'

# GENERATE THE PART-EXCHANGE VIEW IN APRIL 2016

CREATE OR REPLACE VIEW VU_SELECT_PART
AS SELECT DISTINCT PURCHASE.BOUGHT_BY_CUSTOMER_NO,PURCHASE.SOLD_DATE,PURCHASE.CAR_NO,PURCHASE.MAKE,PURCHASE.MODEL,PURCHASE.PURCHASE_PRICE,PURCHASE.PURCHASE_BY_STAFF_NO
FROM CAR PURCHASE, CAR SOLD
WHERE PURCHASE.SOLD_DATE=SOLD.PURCHASE_DATE AND CAR.SOLD_DATE>'04/01/2016' AND CAR.SOLD_DATE<'04/30/2016'

CREATE OR REPLACE VIEW "VU_PART_EXCHANGE_REPORT" ("2016 Part-exchange Report") AS SELECT DISTINCT
CHR(10)||CHR(10)||CUSTOMER.FIRST_NAME||' '||CUSTOMER.SURNAME||' sold '||VU_SELECT_PART.MAKE||' '||VU_SELECT_PART.MODEL||CHR(10)|| ' on
'||TO_CHAR(VU_SELECT_PART.SOLD_DATE,'DD MONTH YYYY')||CHR(10)|| ' as a part-exchange  
at price £'||TO_CHAR(VU_SELECT_PART.PURCHASE_PRICE)||CHR(10)|| ' for sales person
'||STAFF.FIRST_NAME||' '||STAFF.SURNAME AS "2016 Part-exchange Report" FROM VU_SELECT_PART, CAR, CUSTOMER, ADDRESS, STAFF
WHERE VU_SELECT_PART.BOUGHT_BY_CUSTOMER_NO=CUSTOMER.CUSTOMER_NO AND VU_SELECT_PART.PURCHASE_BY_STAFF_NO=STAFF.STAFF_NO AND SOLD_DATE>'04/01/2016' AND SOLD_DATE<'04/30/2016'

# COMBINE VIEWS AND GENERATE THE FINALL VIEW 
CREATE OR REPLACE VIEW "VU_REPORT" ("April 2016 finall Report") AS SELECT
CHR(10)||CHR(10)||' Sales      ：'||CUSTOMER.FIRST_NAME||' '||CUSTOMER.SURNAME||' of '||CHR(10)|| '
'||ADDRESS.LINE_1||', '||CHR(10)|| ' '||ADDRESS.LINE_2||', '||CHR(10)|| '
'||ADDRESS.CITY||CHR(10)|| ' bought a '||CAR.MAKE||' '||CAR.MODEL||CHR(10)|| ' on
'||TO_CHAR(CAR.SOLD_DATE,'DD MONTH YYYY')||CHR(10)|| ' for £'||CAR.SOLD_PRICE||CHR(10)|| '
making a profit of £'||TO_CHAR(CAR.SOLD_PRICE - CAR.PURCHASE_PRICE)||CHR(10)|| ' for sales person
'||STAFF.FIRST_NAME||' '||STAFF.SURNAME AS "2016 Sales Report" FROM CUSTOMER, CAR, ADDRESS, STAFF
WHERE CUSTOMER.CUSTOMER_NO=CAR.BOUGHT_BY_CUSTOMER_NO AND CUSTOMER.ADDRESS_NO=ADDRESS.ADDRESS_NO AND
CAR.SOLD_BY_STAFF_NO=STAFF.STAFF_NO AND CAR.SOLD_DATE>'04/01/2016' AND CAR.SOLD_DATE<'04/30/2016'
union all
SELECT distinct
CHR(10)||CHR(10)||' Purchases    ：'||STAFF.FIRST_NAME||' '||STAFF.SURNAME||' of '||CHR(10)|| '
CARS-4-U SHEFFIELD purchased a '||CAR.MAKE||' '||CAR.MODEL||CHR(10)|| ' on
'||TO_CHAR(CAR.PURCHASE_DATE,'DD MONTH YYYY')||CHR(10)|| ' for £'||CAR.PURCHASE_PRICE||CHR(10)|| ' from customer
'||CUSTOMER.FIRST_NAME||' '||CUSTOMER.SURNAME AS "2016 Purchases Report" FROM CUSTOMER, CAR, ADDRESS, STAFF
WHERE CUSTOMER.CUSTOMER_NO=CAR.SOLD_BY_COSUTOMER_NO AND 
CAR.PURCHASE_BY_STAFF_NO=STAFF.STAFF_NO AND CAR.SOLD_DATE>'04/01/2016' AND CAR.SOLD_DATE<'04/30/2016'
union all
SELECT DISTINCT
CHR(10)||CHR(10)||' Part-exchange ：'||CUSTOMER.FIRST_NAME||' '||CUSTOMER.SURNAME||' sold '||VU_SELECT_PART.MAKE||' '||VU_SELECT_PART.MODEL||CHR(10)|| ' on
'||TO_CHAR(VU_SELECT_PART.SOLD_DATE,'DD MONTH YYYY')||CHR(10)|| ' as a part-exchange  
at price £'||TO_CHAR(VU_SELECT_PART.PURCHASE_PRICE)||CHR(10)|| ' for sales person
'||STAFF.FIRST_NAME||' '||STAFF.SURNAME AS "2016 Part-exchange Report" FROM VU_SELECT_PART, CAR, CUSTOMER, ADDRESS, STAFF
WHERE VU_SELECT_PART.BOUGHT_BY_CUSTOMER_NO=CUSTOMER.CUSTOMER_NO AND VU_SELECT_PART.PURCHASE_BY_STAFF_NO=STAFF.STAFF_NO AND CAR.SOLD_DATE>'04/01/2016' AND CAR.SOLD_DATE<'04/30/2016'



